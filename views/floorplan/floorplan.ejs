<%- include('../partials/floorplanheader.ejs', {hideEverythingBesidesHome:false}) %>

<section id="hero" class="hero d-flex align-items-center">
   <div class="container">
      <div class="row">
         <div class="col-lg-6 d-flex flex-column justify-content-center">
            <h1 data-aos="fade-up">Professional 2D Floor Plan Services</h1>
            <h2 data-aos="fade-up" data-aos-delay="400">
               Transform your architectural drawings into clean, professional floor plans.</p>
               <p>Perfect for building management systems (BMS) integration, facility management, and space planning needs.
            </h2>
            <div data-aos="fade-up" data-aos-delay="600">
               <div class="text-center text-lg-start">
                  <a href="#contact" class="btn-get-started scrollto d-inline-flex align-items-center justify-content-center align-self-center">
                  <span>Get a quote</span>
                  <i class="bi bi-arrow-right"></i>
                  </a>
               </div>
            </div>
         </div>
         <div class="col-lg-6 hero-img" data-aos="zoom-out" data-aos-delay="200">
            <img src="/assets/img/floorplan-sample-1.jpg" class="img-fluid" alt="" style="width: 80%;">
         </div>
      </div>
   </div>
</section>
<!-- Pricing Section -->
<section id="pricing" class="pricing section">
   <!-- Section Title -->
   <div class="container section-title" data-aos="fade-up">
      <h2>Pricing</h2>
      <p>Professional Floor Plan Services<br>Choose the plan that best fits your needs</p>
   </div>
   <div class="container">
      <div class="row gy-4">
         <!-- Basic Small -->
         <!-- Previous code remains the same until the pricing section -->
         <!-- Basic Small -->
         <div class="col-lg-3 col-md-6" data-aos="zoom-in" data-aos-delay="100">
            <div class="pricing-tem">
               <h3 style="color: #20c997;">Basic Small</h3>
               <div class="price"><sup>$</sup>120</div>
               <div class="icon">
                  <i class="bi bi-building" style="color: #20c997;"></i>
               </div>
               <ul>
                  <li>10-20 spaces</li>
                  <li>Walls layout</li>
                  <li>Floor details</li>
                  <li>Door placements</li>
                  <li>Basic measurements</li>
               </ul>
               <a href="https://buy.stripe.com/dR66qF0oeeTpgOk28c" class="btn-buy">Buy Now</a>
            </div>
         </div>
         <!-- Basic Medium -->
         <div class="col-lg-3 col-md-6" data-aos="zoom-in" data-aos-delay="200">
            <div class="pricing-tem">
               <h3 style="color: #0dcaf0;">Basic Medium</h3>
               <div class="price"><sup>$</sup>250</div>
               <div class="icon">
                  <i class="bi bi-building-add" style="color: #0dcaf0;"></i>
               </div>
               <ul>
                  <li>20-40 spaces</li>
                  <li>Walls layout</li>
                  <li>Floor details</li>
                  <li>Door placements</li>
                  <li>Basic measurements</li>
               </ul>
               <a href="https://buy.stripe.com/4gweXb6MC9z569G4gl" class="btn-buy">Buy Now</a>
            </div>
         </div>
         <!-- High-End Medium -->
         <div class="col-lg-3 col-md-6" data-aos="zoom-in" data-aos-delay="300">
            <div class="pricing-tem">
               <span class="featured">Great Value</span>
               <h3 style="color: #fd7e14;">High-End Medium</h3>
               <div class="price"><sup>$</sup>400</div>
               <div class="icon">
                  <i class="bi bi-buildings" style="color: #fd7e14;"></i>
               </div>
               <ul>
                  <li>20-40 spaces</li>
                  <li>All Basic features</li>
                  <li>Interior furniture</li>
                  <li>Plants & decorations</li>
                  <li>Textures & colors</li>
               </ul>
               <a href="https://buy.stripe.com/cN2eXbc6W7qX69GeV0" class="btn-buy">Buy Now</a>
            </div>
         </div>
         <!-- High-End Large -->
         <div class="col-lg-3 col-md-6" data-aos="zoom-in" data-aos-delay="400">
            <div class="pricing-tem">
               <h3 style="color: #0d6efd;">High-End Large</h3>
               <div class="price"><sup>$</sup>700</div>
               <div class="icon">
                  <i class="bi bi-building-check" style="color: #0d6efd;"></i>
               </div>
               <ul>
                  <li>40-70 spaces</li>
                  <li>All Basic features</li>
                  <li>Interior furniture</li>
                  <li>Plants & decorations</li>
                  <li>Textures & colors</li>
               </ul>
               <a href="https://buy.stripe.com/14k6qF2wmdPlfKgeV1" class="btn-buy">Buy Now</a>
            </div>
         </div>
      </div>
      <!-- Add-ons Note -->
      <div class="row mt-5">
         <div class="col-12 text-center">
            <p class="text-muted">
               <strong>Note:</strong> Additional features or other specialized requirements are available with custom quotes.
               <br>Contact us for custom requirements and detailed pricing.
            </p>
         </div>
      </div>
   </div>
   <!-- Estimate Calculator Section -->
   <section id="calculator" class="calculator section">
      <div class="container section-title" data-aos="fade-up">
         <h2>Estimate Calculator</h2>
         <p>Get an Instant Floor Plan Estimate</p>
      </div>
      <div class="container">
      <div class="row justify-content-center">
         <div class="col-lg-8">
            <div class="calculator-box" data-aos="fade-up" data-aos-delay="100">
               <!-- Input Fields -->
               <div class="row gy-4">
                  <div class="col-md-4">
                     <div class="input-group">
                        <label>Number of Spaces</label>
                        <div class="number-input">
                           <button type="button" class="minus">-</button>
                           <input type="number" id="spaces" min="1" max="200" value="10">
                           <button type="button" class="plus">+</button>
                        </div>
                        <small class="tier-indicator d-block text-center">Tier: 10-20 spaces</small>
                     </div>
                  </div>
                  <div class="col-md-4">
                     <div class="input-group">
                        <label>Fixtures</label>
                        <div class="number-input">
                           <button type="button" class="minus">-</button>
                           <input type="number" id="fixtures" min="0" max="500" value="0">
                           <button type="button" class="plus">+</button>
                        </div>
                        <small class="d-block text-center">(outlets, switches, thermostats, etc.)</small>
                     </div>
                  </div>
                  <div class="col-md-4">
                    <div class="input-group">
                      <label>Diffusers &amp; Ductwork</label>
                      <div class="number-input">
                        <button type="button" class="minus">-</button>
                        <input type="number" id="diffusers" min="0" max="500" value="0">
                        <button type="button" class="plus">+</button>
                      </div>
                      <small class="d-block text-center">(HVAC air outlets and duct connections)</small>
                    </div>
                  </div>

               </div>
               <!-- Price Breakdown -->
               <!-- Receipt Breakdown -->
               <div class="receipt" id="estimateReceipt">
                  <div class="receipt__header">
                     <h4 class="receipt__title">Estimate Breakdown</h4>
                     <div class="receipt__meta">Auto-calculated from your selections</div>
                  </div>
                  <div class="receipt__body">
                     <div class="r">
                        <span class="r__label">Base Price (<span id="spacesCount">10</span> spaces):</span>
                        <span class="r__amount"><span class="cur">$</span><span id="basePrice">120.00</span></span>
                     </div>
                     <div class="r">
                        <span class="r__label">Fixtures (<span id="fixturesCount">0</span> × $1.50):</span>
                        <span class="r__amount"><span class="cur">$</span><span id="fixturesPrice">0.00</span></span>
                     </div>
                     <div class="r">
                        <span class="r__label">Diffusers &amp; Ductwork (<span id="diffusersCount">0</span> × $2.00):</span>
                        <span class="r__amount"><span class="cur">$</span><span id="diffusersPrice">0.00</span></span>
                     </div>
                     <div class="r" id="minimumFeeRow" style="display: none;">
                      <span class="r__label">Minimum Service Fee:</span>
                      <span class="r__amount"><span class="cur">$</span><span id="minimumFeeAmount">0.00</span></span>
                    </div>
                     <div class="r r--total">
                        <span class="r__label">Estimated Total</span>
                        <span class="r__amount"><span class="cur">$</span><span id="totalPrice">120.00</span></span>
                     </div>
                  </div>
                  <div id="minChargeNotice" class="min-note" aria-live="polite" hidden></div>
                  <div class="receipt__footer">
                     <button id="requestQuote" class="btn-receipt-cta">
                     Request Official Quote <i class="bi bi-arrow-right"></i>
                     </button>
                  </div>
                  
               </div>
               <p class="disclaimer">
                  * This is an estimate only. All jobs must be reviewed. This is only an estimate. Please submit your floor plan so that our designers can review.
               </p>
            </div>
         </div>
      </div>
   </section>
   <!-- End Estimate Calculator Section -->
   <section id="contact" class="contact">
      <div class="container" data-aos="fade-up">
         <header class="section-header">
            <p>Contact Us</p>
         </header>
         <div class="row gy-4">
            <div class="col-lg-6">
               <div class="row gy-4">
                  <div class="col-md-6">
                     <div class="info-box">
                        <i class="bi bi-geo-alt"></i>
                        <h3>Address</h3>
                        <p>1385 S Huron Rd<br>Kawkawlin, MI 48631</p>
                     </div>
                  </div>
                  <div class="col-md-6">
                     <div class="info-box">
                        <i class="bi bi-telephone"></i>
                        <h3>Call Us</h3>
                        <p>+1 989-322-2000</p>
                     </div>
                  </div>
                  <div class="col-md-6">
                     <div class="info-box">
                        <i class="bi bi-envelope"></i>
                        <h3>Email Us</h3>
                        <p>info@adevity.com</p>
                     </div>
                  </div>
                  <div class="col-md-6">
                     <div class="info-box">
                        <i class="bi bi-clock"></i>
                        <h3>Open Hours</h3>
                        <p>Monday - Friday<br>9:00AM - 05:00PM</p>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-lg-6">
               <form action="/sendEmail" method="post" class="node-email-form" id="contactForm" enctype="multipart/form-data">
                  <div class="row gy-4">
                     <div class="col-md-6">
                        <input type="text" name="name" class="form-control" placeholder="Your Name" required>
                     </div>
                     <div class="col-md-6">
                        <input type="email" class="form-control" name="email" placeholder="Your Email" required>
                     </div>
                     <div class="col-md-12">
                        <input type="text" class="form-control" name="subject" placeholder="Subject" required>
                     </div>
                     <div class="col-md-12">
                        <textarea class="form-control" name="message" rows="6" placeholder="Message" required></textarea>
                     </div>
                     <div class="col-md-12">
                        <label for="attachments" class="form-label">Attachments (optional)</label>
                        <input type="file" class="form-control" name="attachments" id="attachments" multiple accept=".pdf,.jpg,.jpeg,.png,.dwg,.dxf,.skp,.doc,.docx,.xls,.xlsx,.zip">
                        <small class="text-muted">Accepted formats: PDF, JPG, PNG, DWG, DXF, SKP, DOC, DOCX, XLS, XLSX, ZIP. Max 10MB per file.</small>
                    </div>
                     <input type="hidden" id="g-recaptcha-response" name="g-recaptcha-response">
                     <div class="col-md-12 text-center">
                        <div class="loading">Loading</div>
                        <div class="error-message"></div>
                        <div class="sent-message">Your message has been sent. Thank you!</div>
                        <button type="submit" id="submitButton">Send Message</button>
                     </div>
                  </div>
               </form>
            </div>
         </div>
      </div>
   </section>
</section>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Pricing tiers based on spreadsheet
  const spaceTiers = [
    { min: 1,  max: 20,       price: 12 },
    { min: 21, max: 40,       price: 11 },
    { min: 41, max: 70,       price: 10 },
    { min: 71, max: Infinity, price: 10 } // Same as 41-70 tier
  ];

  const fixtureRate   = 1.50;
  const diffuserRate  = 2.00;        // updated rate
  const minimumCharge = 50;          // enforce this

  // Inputs
  const spacesInput    = document.getElementById('spaces');
  const fixturesInput  = document.getElementById('fixtures');
  const diffusersInput = document.getElementById('diffusers');

  // Breakdown display
  const spacesCount     = document.getElementById('spacesCount');
  const fixturesCount   = document.getElementById('fixturesCount');
  const diffusersCount  = document.getElementById('diffusersCount');
  const basePrice       = document.getElementById('basePrice');
  const fixturesPrice   = document.getElementById('fixturesPrice');
  const diffusersPrice  = document.getElementById('diffusersPrice');
  const totalPrice      = document.getElementById('totalPrice');
  const tierIndicator   = document.querySelector('.tier-indicator');

  // Min notice + CTA
  const minNote   = document.getElementById('minChargeNotice');
  const quoteBtn  = document.getElementById('requestQuote');
  const contactSection = document.getElementById('contact');

  // Helpers
  function getBasePrice(spaces) {
    const tier = spaceTiers.find(t => spaces >= t.min && spaces <= t.max);
    const price = tier.price * spaces;

    if (spaces <= 20)       tierIndicator.textContent = 'Tier: Basic Small (10-20 spaces)';
    else if (spaces <= 40)  tierIndicator.textContent = 'Tier: Basic Medium (20-40 spaces)';
    else if (spaces <= 70)  tierIndicator.textContent = 'Tier: Large (40-70 spaces)';
    else                    tierIndicator.textContent = 'Tier: Extra Large (70+ spaces)';

    return price;
  }

  function setButtonState(enabled, shortfall) {
    if (enabled) {
      quoteBtn.removeAttribute('disabled');
      quoteBtn.textContent = 'Request Official Quote';
      minNote.hidden = true;
      minNote.textContent = '';
    } else {
      quoteBtn.setAttribute('disabled', 'true');
      quoteBtn.textContent = `Add $${shortfall.toFixed(2)} to reach $${minimumCharge} minimum`;
      minNote.hidden = false;
      minNote.textContent = `Minimum order is $${minimumCharge}. Your current estimate is $${(minimumCharge - shortfall).toFixed(2)} — add $${shortfall.toFixed(2)} more to continue.`;
    }
  }

  // Recalculate & update UI
  function updatePrices() {
    const spaces    = parseInt(spacesInput.value)    || 0;
    const fixtures  = parseInt(fixturesInput.value)  || 0;
    const diffusers = parseInt(diffusersInput.value) || 0;

    const basePriceValue      = getBasePrice(spaces);
    const fixturesPriceValue  = fixtures  * fixtureRate;
    const diffusersPriceValue = diffusers * diffuserRate;
    const subtotal            = basePriceValue + fixturesPriceValue + diffusersPriceValue;

    // Minimum check (PROMINENT, not a line item)
    if (subtotal < minimumCharge) {
      const shortfall = minimumCharge - subtotal;
      setButtonState(false, shortfall);
      totalPrice.textContent = minimumCharge.toFixed(2); // still show min as total
    } else {
      setButtonState(true, 0);
      totalPrice.textContent = subtotal.toFixed(2);
    }

    // Update breakdown numbers
    spacesCount.textContent    = spaces;
    fixturesCount.textContent  = fixtures;
    diffusersCount.textContent = diffusers;
    basePrice.textContent      = basePriceValue.toFixed(2);
    fixturesPrice.textContent  = fixturesPriceValue.toFixed(2);
    diffusersPrice.textContent = diffusersPriceValue.toFixed(2);
  }

  // +/- buttons
  document.querySelectorAll('.number-input').forEach(group => {
    const input = group.querySelector('input');
    const minus = group.querySelector('.minus');
    const plus  = group.querySelector('.plus');

    minus.addEventListener('click', () => {
      const min = parseInt(input.min);
      const current = parseInt(input.value) || 0;
      if (current > min) {
        input.value = current - 1;
        updatePrices();
      }
    });

    plus.addEventListener('click', () => {
      const max = parseInt(input.max);
      const current = parseInt(input.value) || 0;
      if (current < max) {
        input.value = current + 1;
        updatePrices();
      }
    });
  });

  // Direct input change
  [spacesInput, fixturesInput, diffusersInput].forEach(input => {
    input.addEventListener('input', updatePrices);
  });

  // Request Quote
  quoteBtn.addEventListener('click', function(e) {
    // If disabled due to minimum, stop and focus the notice
    if (quoteBtn.hasAttribute('disabled')) {
      e.preventDefault();
      minNote.scrollIntoView({ behavior: 'smooth', block: 'center' });
      return;
    }

    const spaces    = spacesInput.value;
    const fixtures  = fixturesInput.value;
    const diffusers = diffusersInput.value;
    const total     = document.getElementById('totalPrice').textContent;

    const message = `I would like an official quote for a floor plan with the following specifications:

Spaces: ${spaces}
Fixtures: ${fixtures}
Diffusers & Ductwork: ${diffusers}

Estimated Total: $${total}

Please review and provide an official quote.`;

    const messageField = document.querySelector('textarea[name="message"]');
    const subjectField = document.querySelector('input[name="subject"]');

    if (messageField) messageField.value = message;
    if (subjectField) subjectField.value = 'Floor Plan Quote Request';

    contactSection.scrollIntoView({ behavior: 'smooth' });
  });

  // Init
  updatePrices();
});
</script>

<%- include('../partials/floorplanfooter.ejs') %>